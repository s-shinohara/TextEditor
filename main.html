<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<style>
#editorOuterbox {
  width: 100%;
  background: #FFF;
  
  position: fixed;
  top: 0;
  left: 0;
  
  height: 2em;
}
  
#bOuterbox {
  margin: 8em 0 0;
}
</style>

</head>
<body>

<div id="editorOuterbox">
<form id="editor" name="editor">
<div id="textBeingEditedOuterbox">
  <textarea id="textBeingEdited" rows="1" cols="5" onChange="copy()"></textarea>
</div>
<div id="startOuterbox">
  <input type="number" id="startNum" defaultvalue="0" placeholder="0" />
  <input type="button" class="setSelectionRange start back" value=" < " />
  <input type="number" id="startNumberDelta" defaultvalue="0" placeholder="0" />
  <input type="button" class="setSelectionRange start forward" value=" > " />
</div>
<div id="endOuterbox">
  <input type="number" id="endNum" defaultvalue="0" placeholder="0" />
  <input type="button" class="setSelectionRange end back" value=" < ">
  <input type="number" id="endNumberDelta" defaultvalue="0" placeholder="0" />
  <input type="button" class="setSelectionRange end forward" value=" > ">
</div>
<div id="replaceOuterbox">
  <input type="button" id="replace" value="replace" />
  <input type="text" id="replaceTo" placeholder="hogehoge" />
</div>
</form>
</div>
  
<div id="bOuterbox">
  <div id="b">
  </div>
</div>
  
<script>
function copy() {
  var elementB = document.getElementById("b");
  elementB.textContent = document.getElementById("textBeingEdited").value;
}

function changeSelectionRange(startOrEnd, backOrForward) {
  var textBeingEdited = document.getElementById("textBeingEdited");
  var startNumberDelta = document.getElementById("startNumberDelta");
  var endNumberDelta = document.getElementById("endNumberDelta");
  var selectionStart = textBeingEdited.selectionStart;
  var selectionEnd = textBeingEdited.selectionEnd;
  var delta;
  
  if (startOrEnd == "start") {
    delta = startNumberDelta;
  } else if (startOrEnd == "end") {
    delta = endNumberDelta;
  }
  
  if (backOrForward == "back") {
    delta = -1 * delta;
  }
  
  if (startOrEnd == "start") {
    selectionStart = selectionStart + delta;
    if (selectionStart < 0) selectionStart = 0;
    if (selectionEnd < selectionStart) selectionEnd = selectionStart;
  } else if (startOrEnd == "end") {
    selectionEnd = selectionEnd + delta;
    if (selectionEnd < selectionStart) selectionEnd = selectionStart;
  }
  textBeingEdited.setSelectionRange(selectionStart, selectionEnd);
  textBeingEdited.focus();
}
  
window.onload = function() {
  var startOrEnd;
  var backOrForward;
  
  var element;

  for(element in document.input) {
    if (element.className == "setSelectionRange") {
      if (element.className == "start") {
        startOrEnd = "start";
      } else if (element.className == "end") {
        startOrEnd = "end";
      }

      if (element.className == "back") {
        backOrForward = "back";
      } else if (element.className == "forward") {
        backOrForward = "forward";
      }
      
      element.onClick = changeSelectionRange(startOrEnd, backOrForward);
    }
  }
  
  if (element.id == "replace") {
    element.onClick = function() {
      var textBeingEdited = document.getElementById("textBeingEdited");
      textBeingEdited.value = document.getElementById("replaceTo").value;
    }
  }
}
  
</script>

</body>
</html>
